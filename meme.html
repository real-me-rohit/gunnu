<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Video Meme Flipbook</title>
  <style>
  body {
  margin: 0;
  background: #111;
  color: white;
  font-family: Arial, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  height: 100vh;
  overflow: hidden;
}

.flipbook {
  width: 95%;
  max-width: 800px;
  height: auto;
  position: relative;
}

.page {
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.page.active {
  display: flex;
}

video {
  width: 100%;
  max-height: 90vh;
  border-radius: 16px;
  box-shadow: 0 0 25px rgba(255,255,255,0.3);
}

.nav-buttons {
  margin-top: 25px;
  display: flex;
  justify-content: space-between;
  width: 100%;
}

button {
  background-color: #ff6b6b;
  color: white;
  padding: 15px 30px;
  border: none;
  font-size: 22px;
  border-radius: 14px;
  cursor: pointer;
  transition: 0.2s;
}

button:hover {
  background-color: #ff4d4d;
  transform: scale(1.05);
}

#final-scene {
  display: none;
  flex-direction: column;
  align-items: center;
  margin-top: 30px;
}

#final-scene h2 {
  font-size: 36px;
  margin-bottom: 25px;
  text-align: center;
}

.final-btns {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
  justify-content: center;
}

.final-btns button {
  font-size: 20px;
  border-radius: 25px;
  padding: 14px 22px;
  min-width: 180px;
}

#kutteVideoWrapper {
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  margin-top: 20px;
}

#kutteVideoWrapper video {
  width: 90vw;
  max-height: 90vh;
  border-radius: 16px;
  box-shadow: 0 0 30px rgba(255,255,255,0.3);
}

#backBtn {
  display: none;
  margin-top: 20px;
  padding: 12px 24px;
  background-color: #ff6b6b;
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 18px;
  cursor: pointer;
}

audio {
  display: none;
}

@media (max-width: 900px) {
  .flipbook {
    max-width: 100%;
  }

  video {
    max-height: 65vh;
  }

  .nav-buttons {
    flex-direction: column;
    gap: 15px;
  }

  .nav-buttons button,
  .final-btns button {
    width: 100%;
    font-size: 18px;
    padding: 14px;
  }

  #final-scene h2 {
    font-size: 28px;
  }
}


  </style>
</head>
<body>

  <div class="flipbook">
    <div class="page active">
      <video id="vid1" src="./library/video1.mp4" autoplay controls playsinline></video>
    </div>
    <div class="page">
      <video id="vid2" src="./library/video2.mp4" autoplay loop controls playsinline></video>
    </div>
    <div class="page">
      <video id="vid3" src="./library/meme1.mp4" autoplay loop controls playsinline></video>
    </div>
    <div class="page">
      <video id="vid4" src="./library/sharukh.mp4" autoplay loop controls playsinline></video>
    </div>
    <div class="page">
      <video id="vid5" src="./library/meme2.mp4" autoplay loop controls playsinline></video>
    </div>

    <div class="nav-buttons" id="navBtns">
      <button onclick="prevPage()">Previous</button>
      <button onclick="nextPage()">Next</button>
    </div>
  </div>

  <!-- Final emotional scene -->
  <div id="final-scene">
    <h2>Abhi bhi nahi manogi?</h2>
    <div class="final-btns">
      <button onclick="showKutteVideo()">Ja maaf kiya tujhe</button>

      <button onclick="playSadAudio()">Still NO</button>
    </div>
  </div>


  <div id="kutteVideoWrapper">
  <video id="kutteVideo" src="./library/monkey.mp4" controls></video>
  <button id="backBtn" onclick="hideKutteVideo()">Back</button>
</div>



  <audio id="cryAudio">
    <source src="./library/abe-sale.mp3" type="audio/mpeg" />
  </audio>

  <script>
    const pages = document.querySelectorAll('.page');
    let currentPage = 0;

    // Function to stop all audio (video & audio elements)
    function stopAllAudio() {
      // Stop all videos
      pages.forEach(page => {
        const video = page.querySelector('video');
        if (video && !video.paused) {
          video.pause();
          video.currentTime = 0; // Reset to the beginning
        }
      });

      // Stop any other audio
      const cryAudio = document.getElementById('cryAudio');
      if (cryAudio && !cryAudio.paused) {
        cryAudio.pause();
        cryAudio.currentTime = 0; // Reset to the beginning
      }
    }

    function showPage(index) {
      pages.forEach((page, i) => {
        page.classList.toggle('active', i === index);
        const video = page.querySelector('video');
        if (i === index) {
          video.currentTime = 0;
          video.play().catch(() => {
            document.body.addEventListener('click', () => video.play(), { once: true });
          });
        } else {
          video.pause();
        }
      });
    }

    function nextPage() {
      stopAllAudio(); // Stop all audio before switching pages

      if (currentPage < pages.length - 1) {
        currentPage++;
        showPage(currentPage);
      } else {
        document.querySelector('.flipbook').style.display = 'none';
        document.getElementById('final-scene').style.display = 'flex';
      }
    }

    function prevPage() {
      stopAllAudio(); // Stop all audio before switching pages

      if (currentPage > 0) {
        currentPage--;
        showPage(currentPage);
      }
    }

    function playSadAudio() {
      stopAllAudio(); // Stop any current audio before playing sad audio

      const audio = document.getElementById('cryAudio');
      audio.play();
      audio.onended = () => {
        window.location.href = "poetry.html"; // Change to your actual page
      };
    }

    window.addEventListener('DOMContentLoaded', () => {
      showPage(0);
    });


let lastStoryDisplay = null;

function showKutteVideo() {
  const modal = document.getElementById('storyModal');
  lastStoryDisplay = modal ? modal.style.display : null;
  if (modal) modal.style.display = 'none';



  const headerText = document.querySelector('#final-scene h2');
if (headerText) headerText.style.display = 'none';

  const kutteBtns = document.querySelector('.final-btns');
  if (kutteBtns) kutteBtns.style.display = 'none';

  const wrapper = document.getElementById('kutteVideoWrapper');
  const video = document.getElementById('kutteVideo');
  wrapper.style.display = 'flex';
  video.currentTime = 0;
  video.play();

  setTimeout(() => {
    document.getElementById('backBtn').style.display = 'block';
  }, 5000);

  video.onended = () => {
    hideKutteVideo();
  };
}

function hideKutteVideo() {
  
  const wrapper = document.getElementById('kutteVideoWrapper');
  const video = document.getElementById('kutteVideo');
  video.pause();
  wrapper.style.display = 'none';
  document.getElementById('backBtn').style.display = 'none';

  const modal = document.getElementById('storyModal');
  if (modal) modal.style.display = lastStoryDisplay || 'flex';


  const headerText = document.querySelector('#final-scene h2');
if (headerText) headerText.style.display = 'block';

  const kutteBtns = document.querySelector('.final-btns');
  if (kutteBtns) kutteBtns.style.display = 'flex';
}

window.addEventListener('DOMContentLoaded', () => {
  const kutteBtn = document.querySelector(".final-btns button");
  if (kutteBtn && kutteBtn.innerText.includes("kutte")) {
    kutteBtn.setAttribute("onclick", "showKutteVideo()");
  }
});




  </script>

</body>
</html>
